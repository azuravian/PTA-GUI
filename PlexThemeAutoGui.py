import os
import pickle
import re
import shutil
import tempfile
import textwrap
import webbrowser
from json import dump as jsondump
from json import load as jsonload
from json import loads
from os.path import exists
from urllib.request import Request, urlopen

import lorem
import PySimpleGUI as sg
import requests
import urllib3
from moviepy.editor import AudioFileClip as afc
from PIL import Image, ImageFont
from plexapi.server import PlexServer
from pytube import YouTube
from strsimpy import SIFT4
from youtubesearchpython import VideosSearch

FOLDER = 'application/vnd.google-apps.folder'
#GDRIVEID = ""
plexmovies = []
filterlist = []
gdmovies = []
filterstate = False
#APIKEY = ""
#PLEX_URL = ""
#PLEX_TOKEN = ""
#LIBRARY = ""
WORKING_DIR =os.path.dirname(__file__)
SETTINGS_FILE = os.path.join(WORKING_DIR, 'settings_file.cfg')
NO_POSTER = os.path.join(WORKING_DIR, 'noposter.png')
DEFAULT_SETTINGS = {'plex_url': 'http://127.0.0.1:32400', 'plex_token': None , 'gdriveid': '128O8hwhxmPppwJ3ssGKQoepMrKLB5tNA', 'apikey': 'AIzaSyA60Ypw9Xv2hXusCBUEfTDrbgrB8J4ZA5g', 'library': 'Movies', 'theme': sg.theme('DarkGrey11')}
# "Map" from the settings dictionary keys to the window's element keys
SETTINGS_KEYS_TO_ELEMENT_KEYS = {'plex_url': '-PLEX URL-', 'plex_token': '-PLEX TOKEN-', 'gdriveid': '-GDRIVE ID-', 'apikey': '-APIKEY-', 'library': '-MOVIE LIBRARY-', 'theme': '-THEME-'}
on_image = b'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TXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNC40LjAtRXhpdjIiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgICB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIgogICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgeG1sbnM6R0lNUD0iaHR0cDovL3d3dy5naW1wLm9yZy94bXAvIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgIHhtcE1NOkRvY3VtZW50SUQ9ImdpbXA6ZG9jaWQ6Z2ltcDoxZGFjMDBkYy0zZmZjLTRiMTgtYTJjOC0yMjk2ZjVhOTY4YjYiCiAgIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ZDBhZjZkZGYtMGU0Zi00OWYwLTg2ZjAtZmE3YzQwZWRmM2QzIgogICB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZjBmNGY1MWYtOTBkMS00YThlLWJhMzYtNTc3YjcxN2NhYTFiIgogICBkYzpGb3JtYXQ9ImltYWdlL3BuZyIKICAgR0lNUDpBUEk9IjIuMCIKICAgR0lNUDpQbGF0Zm9ybT0iV2luZG93cyIKICAgR0lNUDpUaW1lU3RhbXA9IjE2NzAxMjk4NjAzNzExMjkiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zMiIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiCiAgIHhtcDpNZXRhZGF0YURhdGU9IjIwMjI6MTI6MDNUMjM6NTc6NDAtMDU6MDAiCiAgIHhtcDpNb2RpZnlEYXRlPSIyMDIyOjEyOjAzVDIzOjU3OjQwLTA1OjAwIj4KICAgPHhtcE1NOkhpc3Rvcnk+CiAgICA8cmRmOlNlcT4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MWFhODZjNWYtZmRkYy00ODY4LWFlZjktMmM3ZjZkMDJhODkwIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKFdpbmRvd3MpIgogICAgICBzdEV2dDp3aGVuPSIyMDIyLTEyLTAzVDIzOjU3OjQwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pl06t6cAAAAGYktHRAAAAAAAAPlDu38AAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAHdElNRQfmDAQEOSh6Y6X1AAAEQElEQVRYw82XW28bRRiGn5kd2yElOGroJjixUCVOKe0FrSpCiBBJKeLQqlLhDkXcIH5Di4TEHRdcpco/KIJcEIFyEyQIcEMhHCJaqhRBTE1xjs1BSX1IvLszXOzasZs2iR2c5JXGa43Wu9/j751vvhH4qu/v7++Zm5/tzmazDZTJlHxWJ8d1uDFx3T157DnZdLCpPhwOr1JDeZ7nWpZ1bWJi4su+vr4kgGpsbGy8dKnvk9Hfrrx0859kaC2/CggQ5aA7ga0LRzh/5k1OvXiaWCyGEIJaa3l5mbGxsclUKnV+cHDwJ3Xh4oV3vv3x61cHvrlMnQruEmCkfy2OKpVdg/feep+zr52jtbUV13VxHKemkJFIhPr6erq6ulrz+fzHyWSyU+XdtXd//v2HIqSRgBVcJRhrHb7suh0ZOCDg2eOdNDc3A2BZVs0zWnh+NBolHo/He3t7n1T2IfvwUnbWv6MAqcCEAkgFptqsGmiNxFFKoZQqBmFZFrulaDRa19bW1qiUUgpM0a7GCiAjJbAygK0ClCx7LmMMaj3fwdosyagOBxm1qrAtgAZy7AupcnODKGS1YNtQsF4LoJWUXsm+URHUiJIhS4YIAq7Gunofgm4sXSV2bgH9GJgHQNwB+SeIJdCHwRwC6yqwCvoo4IH8g30nuVUxMQfBOe1bWN4E3QRuD1AH5hHwngbvSJDAw2DiO2yj9gQU8J4BsQrqe5AJCH3lV2Tdtm5P7ykw0f0JuLV1CzoAuEA+sLIGkQ7AAJH17ey+cFfnuEfbyL0ah+2BZoCHgTDgBHvqgyBW/PWJAesKuGeC6ry6/UAqDbzSeSnl9kGtq+C8Dm4nyH99m4p88N0O/rlFkNfAO7l50FrrbQdeCeR2/sAtQcVtf116j/uVVy6BHPUzJ2ZArvlZtv7ybS7u3HsrMsbged7egwoT1BLjD2Gg8HsxDWpmI4BMlJS0NbBGN9lStd4AulPArZ5x3zUqCpAajAfCCyDMzhsGrTWu6+5KNgtzhYNEOagJAvP8KiuckpZPlLSBlRyXzP2t+39Yc6t7S2tCOWgAKx3QIrCvG4BWc1TT5VktgNYKcrN5ZYxByQiQRmg/mwaQBcigz5XVgBpY0xkwEAqFAHBdt2bFp3ReSkk4HC6+T6XTmZUnYsce+iXxXXF94gaNgXvXyaUK/Z1Z5PbCHJlMhmg0yuLiIrlcruI9tRJIy7KwbRulFKlUykxNTTlqenLm83OvvPH2wmezXJ+84Weu9Hy6w1YnBHz6xWXaWuOcOH4C27Z3pUtyXZfx8XESicTcwMBAQnR3d7d3dHQMH2lvf/TW7C2yufQG/+2shRU4Tp7llWVOPf8yLc0thMPhmkJqrZmfnyeZTOZHRkY+HBoa+kAA9PT0HLVt+2IsFjsbCoUaavHy3GqOTDZNtCGKpVTNIAUCY4xeWFj4dXp6+qPh4eFBQP8HkVcmqgq4DdIAAAAASUVORK5CYII='
off_image = b'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QpR2jRQTaTqPe/hHHH+KXDK5KmDkWEANKiTHD/4Hv3trFqen3KRQHOh5se2PMSC4C7Qatv19bNutE8D/DFxpHX+tCcQ+SW90tMgRMLANXFx3NHkPuNwBhp90yZAcyU9LKBaB9zP6pjwweAv0rbl9a5/j9AHIUq+Wb4CDQ2C8RNnrHu/u7e7bvzXt/v0Aho1yr0OCcVEAAA12aVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOjQ5M2IyZmU2LWM5YmEtNDA5Ni05MDgwLWEzNWMzZDE0YmM0YSIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2NGFjYzhjZi02MDVkLTQxNmUtOWRmYS1iZjdhNjFjNjQyNzIiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpmMzMzMDliOC1hZWYyLTRjMjMtYWYxOC0wMTM2YjVhYzlmNDAiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJXaW5kb3dzIgogICBHSU1QOlRpbWVTdGFtcD0iMTY3MDEyOTg4MTg4MjgyMCIKICAgR0lNUDpWZXJzaW9uPSIyLjEwLjMyIgogICB0aWZmOk9yaWVudGF0aW9uPSIxIgogICB4bXA6Q3JlYXRvclRvb2w9IkdJTVAgMi4xMCIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMjoxMjowM1QyMzo1ODowMS0wNTowMCIKICAgeG1wOk1vZGlmeURhdGU9IjIwMjI6MTI6MDNUMjM6NTg6MDEtMDU6MDAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDplZTJhNjZlYi0wYTczLTQ1YjMtOTgzYy1lOGExOGU2YjNiMDYiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoV2luZG93cykiCiAgICAgIHN0RXZ0OndoZW49IjIwMjItMTItMDNUMjM6NTg6MDEiLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogIDwvcmRmOkRlc2NyaXB0aW9uPgogPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8+qyH7QQAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAAd0SU1FB+YMBAQ6ARP8bloAAATBSURBVFjDzZjNbxNHFMB/s157bZz4Iw0xSkgdCQENXKgIKAipVKIH1Eg9tOqxqsSRHjgicUDqhUP9L7TKrQIObSUEQoJWBOpAFKEmpS0hwYUiwDIS/vZ6vV/TQ9fGBAIBxyVPGu3o7fh5fvPezLy3gv8kmEqlPgqFQp8EAoFBQNItkZJyqdSTWVzMO6apRSIRiRBrY7qt3xuL3Q719Pxw7NixaQABhCYnJyf37Nnz6cjIiN/n89FtMU2T+bk5fj5/ntlLl0DKNYGUQrRgI/39jO3fX2tA6sSJE1+LVCr1+cTExPejo6Oq67o0Gg2k7I5DhRD4/X5UVcV1Xa5cvsw3x49TnplB6RDS9ZoD2N7TAQ6fPFlsCPGBGg6HP0smkyqAoihomtZVbwovTBVFYfuOHWzZto2FmRl6OvGkB2UBJmB4fYCbc3OxvQcOfKiGw+Gkojxdz/Z+t8WvqkQiEWLAxg69aXuANcDnPV3AMAzKpVKfKoRQecsSBxIdglqADgQ8fTN0hdfeOiRAL9DXIajpQUqgAdQ9DwspQcr1AaoBGzoEVb2+4QGr8MwBty5AfR1MRLY1v2enCSnWG2hzH4WHh0lu3Uqkt5eGafLwwQNyN28Sisd5b+/e1njXcbgzP8/Qli2Eo9GWVx8Vi1yfmWnZa9peN6EL4I9EeH98HFdK7iwsEOvrY9fu3fwuJbV8nsHhYf6Yn8exLFzHwapWGRgaQtd1co8e4QhBoVpd0f66Ae1NJIhEo1w6fRqzUuEx0L9pE+9u387C9etIKdHLZex6Hce2Mev1VpZVKxSwgEI2u2Lu+r+BvirbCmoaDcPAtqzW3jN0nWAohKIo+FSVXePjAOj1OlfPnAEp2ZxMsmnzZlwp+eXiRXLZ7KtBXyf1e9HYlX6/Gru6YaAFg2jhMLphoAAbenpomCau62JbFtMXLmA+foxsnqhCcHdxkTvpNBZQeon9FqjjOB1PfLXwUspWKtiUajZLPp9n/NAh/r51i1h/PxuCQRZu3GjZsKXEXmbPkRJLSqxXlFxq8487Be10rFWr8dvUFEM7dxLfuBHTtplNp8kvLaFFo9zLZLBrtWdgHt6/T6VYfK5Mky8o3VoetW27tcrdAlxJ73jXg/7kCUtXrjz3vl4q8efU1HP6zOxs62px2lqzkpFPK4mVPdptbwohaBbclpeyvam4bVWL4fVtT//SPdqN0FyubwetAeUOQB0PTvds1b3Fc5eHrhACx3HWJAxXq/f7/a1JFL18t9MyrQ5UPdiGtwBSCKQQqJZlSYBAIICu663JvOxKWP7udcY2FzYajVKtVjEaDQrLwuxNC+9m+NY9UBtQVRWfz6ep2Ww2VyqVSCQSuK5LpVLpCGI192Y8HicYDLK0tMQ/9+6he5Ps5IOY0/YZxWrboyPJJEJRCmoul/vx2rVrH+/bt09JJBJEo9GuZ0mO45DJZLh47hx3X3DKvolHaTttXa8imjh6lOToqH41nf5VALEjR478NDY2dmBgYIBQKNR10HKpxF9zc1SLRRKDg2ubanpbo29ggFKlYqenp787derUVwIgFou9c/DgwS9isdiXmqYlugkppUSv1VB9PkLhcNe+OFYqlduFQuHbs2fPngGsfwEThJeKNjJfUwAAAABJRU5ErkJggg=='
off_image_disabled = b'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RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOjc2ZTczODdlLThhMDQtNDQ5My05MTEyLTNmYzgyNjI5YmQxMSIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpkOTdlN2Y4Ni03NzM5LTRkYmUtYTJlMy02NThmNDViZjNlNWYiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpmMDU2YWI3NC04YTcxLTQ1MGItYjE3MS0zZGEwY2JjZjdmZDIiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJXaW5kb3dzIgogICBHSU1QOlRpbWVTdGFtcD0iMTY3MDEyOTkwODUwNjk2NSIKICAgR0lNUDpWZXJzaW9uPSIyLjEwLjMyIgogICB0aWZmOk9yaWVudGF0aW9uPSIxIgogICB4bXA6Q3JlYXRvclRvb2w9IkdJTVAgMi4xMCIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMjoxMjowM1QyMzo1ODoyOC0wNTowMCIKICAgeG1wOk1vZGlmeURhdGU9IjIwMjI6MTI6MDNUMjM6NTg6MjgtMDU6MDAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo0MDllNTI5Yi0xNzhmLTQyZGUtYjE3YS03NGJhZTQzMGE0MGYiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoV2luZG93cykiCiAgICAgIHN0RXZ0OndoZW49IjIwMjItMTItMDNUMjM6NTg6MjgiLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogIDwvcmRmOkRlc2NyaXB0aW9uPgogPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8+plymIQAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAOwgAADsIBFShKgAAAAAd0SU1FB+YMBAQ6HHD6AoMAAAN5SURBVFjD3Ve7buNWED33QVKiJNtUaBiKinR2JRf+gE2KVClSJEhlJPmW1PmFACkCuHCxgf8hSBHAnZt164dAQjZpyiZlDnlvGpOhJT/WlugVMoAA4kKcmcMz98wMA4C9vb3GYDD4WgjxrRDicwAaNVqapu3xeHzJObcMw6glFuf8gxDi/fb29t8AwPb395s7Ozu/d7vd79rttsEYQ92mlEIQBDg9PYXnedB68VillOj1ejec818Hg8Ev7Ojo6Id+v7+3uroqtdZQStUSGAAYY2CMgXMOrTV838fh4SHSNF2I/2reWmswxrC5uRlqrd9JIcT3rVZLFokIIWoFWn1eWVmB4zjwfR+LqCSt9QxYz/PWer3eV9IwjC+mg7xF+d7dI5imOXdMxljJ4DTYLMtARF3JGJP4xFZU0qLZrPr/5CALZjnncwNVSt27n1WwHP8TK0SuELziV6rwsiQ5ry48J6BymVgxDAOdTgeWZSHLMtzc3CCOY0gp4TjOPVBhGKLT6UDK/yAkSYIwDJcbKOcc6+vrJYhGowHXdXFxcQEigm3buLy8LEVHKQXbtpGmKZIkgdYaRPS4/2UBapomTNOE7/tIkgRBEICI0G63y7K+axUgIuR5Xk5Zxdnt7e3yl66UEnmel8oJAHmel2rMGIPrugAAIsJwOITWGq1WC7ZtF8MBkiR5PdCXTEqvnaqICEIISClBRGVvLZjTWmM4HJYfohCwKIoQRdG99vIk0McSnHcc/Nj3iQiTyQQbGxuIogiWZcEwDIRhWPpQSs2Aqc7nT8WS1Y2ibtae22hGoxFarRYsy0Ke5/B9H5PJBEKIkrWqXV9fP3kvZ4DWkfhrfGZZhqurq5nzPM8RBMHM+UP/fXXp1s3kQ3PqPD4KP9M+ZR0gXuprXqBVcI/Fl9U15y2ZrI58SqlSXRfF6nTOUimli8kky7I3Y9OyrHuNfxEf8yGgd23IknEce2maotlsljJft/qapgkhBMbjcdk+XqL6z+VQLeFutwulVCCTJPlzNBp947oubzabMAyj9ilIa43xeIyTkxPEcbwQMZoGKIRAv9/H2tpa7Pv+X/L8/Pw95/wnIvqy0WjMvQB/bBsJwxBpmmJra6uWGHcbUOZ53h/Hx8f/MAA4ODj4zHGcH03T/JlzvlE3m0qpclGuy4joAxH9dnZ2tr+7u0v/AuGVWlOH+nK2AAAAAElFTkSuQmCC'
on_image_disabled = b'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jRQTaTqPe/hHHH+KXDK5KmDkWEANKiTHD/4Hv3trFqen3KRQHOh5se2PMSC4C7Qatv19bNutE8D/DFxpHX+tCcQ+SW90tMgRMLANXFx3NHkPuNwBhp90yZAcyU9LKBaB9zP6pjwweAv0rbl9a5/j9AHIUq+Wb4CDQ2C8RNnrHu/u7e7bvzXt/v0Aho1yr0OCcVEAAA12aVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgeG1wTU06RG9jdW1lbnRJRD0iZ2ltcDpkb2NpZDpnaW1wOjAzOWI1YzA4LTVhZTAtNGM5ZC1hYjBhLTcxM2NhNmZiNjMzNSIKICAgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDowY2ZmMDRjNS1lMjdhLTRiYWQtODg5MS1iYzYzYzA2ZWU2MWUiCiAgIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpiMmM4NzFjNC1jNGFiLTQwNGMtOTFlNi1hMDkyOWY3Mjc1YjkiCiAgIGRjOkZvcm1hdD0iaW1hZ2UvcG5nIgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJXaW5kb3dzIgogICBHSU1QOlRpbWVTdGFtcD0iMTY3MDEyOTk1MTYxMzExNyIKICAgR0lNUDpWZXJzaW9uPSIyLjEwLjMyIgogICB0aWZmOk9yaWVudGF0aW9uPSIxIgogICB4bXA6Q3JlYXRvclRvb2w9IkdJTVAgMi4xMCIKICAgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMjoxMjowM1QyMzo1OToxMS0wNTowMCIKICAgeG1wOk1vZGlmeURhdGU9IjIwMjI6MTI6MDNUMjM6NTk6MTEtMDU6MDAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpmYmIzYjY3OS00MTU3LTQ0ZWUtYWRiZi1lMjI0YmYzOGNlMDAiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoV2luZG93cykiCiAgICAgIHN0RXZ0OndoZW49IjIwMjItMTItMDNUMjM6NTk6MTEiLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogIDwvcmRmOkRlc2NyaXB0aW9uPgogPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8++R8kgAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAOwgAADsIBFShKgAAAAAd0SU1FB+YMBAQ7C+oytgUAAAMeSURBVFjD1Vi7TtxAFD0zHo/tWUBIW9CQDZFAoQg/kAIlUQoK0uQH0qWjS5NPiPiB1BTpUDqUb4hIkw5BJECkWSSQzZqxjWduKlveZcNr7QWOZO3Ya8/cc8+ZmathALCxsaGWlpbepGn62lo7iZphrUUcx7lSigdBoDjnCRoEEeWMsd+9Xu/H8vLyPgCwzc3N6cXFxW8nJydvwzB0rbW1D+w4DjqdDmZmZhAEAcaBi4sLnJ6e/t3d3X2/srLyk21vb3+Komj9+PgYjLFLHwx7dsvsYm5uDvPz8wiCAESEJpJZBeccjDFkWYZut7u7s7PzUgD4GIZhH6H/te86aLvdhu/7ZX+O44xFVSkllFJPZmdnnwvXdZ8ZY/qIFeSq7buq6bpumeH7gOu6fhAE04IxJoapxzkfWdH7IjcM4qoA71OJxokWdq1znj4E8KtsN+ocfdCKDn1JCHieB845jDFI0xTGGEgpIYSA1hpEBN/3QURI0/TxKFolOTU1Ve5LruuW90IIKKXKrUNKCSnl47JuAd/3ixIOaZoiiiIwxkpCRIQgCMa2NzZmXc45iAhEVBKz1pbErLUwxmBiYqL8/1Eqaq3t22YYY+VcLYjFcQzHcSCEqD3AIsl3uW6laJIk8DwPrVYLWZaVC06WZWWBboyB1hqtVuvaoOsg3oh18zxHGIbwPA++78MYgziOQUTI87wvIVWlRw3ytoSGvV9Ud1cSJaLSrnme95EqkGUZsizrs/B1FmxStcHvq/2Iq0jWYbVqwVHtb9w2FjcleZcKqeqKmypal5qXFB3M+CDJol1HKTjMUuNalMR19qoqMop1i986ThduGktRAwCAMMZEUsoprXUjc8kYgyRJkOc5XNct6+Q6iQ66kDEG3/fBOcf5+TlprS9Er9f73ul0PhwcHGAY2TrOjPb396GUQrvdLs+NmgYRIQxDnJ2ddY+Ojv6IKIq+CCFeLSwsPNVaD812HQvE4eEhtNZjqYuJCEmSII7jrNvtfl1dXf3DAGBra+uFlPKzUuod53yyicGttaV9xwCbpukvrfX63t7e5tramv0HoYH/hdTW7ukAAAAASUVORK5CYII='

#Load configdata
def get_paths():
    """Makes temporary directory and creates paths for storing mp3 and mp4 during processing

    Returns:
        (tuple): a tuple containing:
            tpath (str): temporary directory path
            mp3path (str): path to store mp3 during processing
            mp4path (str): path to store mp4 during processing
    """
    tpath = tempfile.mkdtemp()
    mp3path = os.path.join(tpath, 'theme.mp3')
    mp4path = os.path.join(tpath, 'theme.mp4')
    return tpath,mp3path,mp4path
#End load configdata

################################ Load/Save Settings File ################################
def load_settings(settings_file, default_settings):
    """Reads settings file (JSON) and return dict containing settings

    Args:
        settings_file (str): path to settings file (JSON)
        default_settings (dict): contains settings to use if no settings file is found

    Returns:
        dict: settings read from settings.cfg or created using default_settings
    """
    try:
        with open(settings_file, 'r', encoding='UTF-8') as f:
            settings = jsonload(f)
    except Exception as e:
        sg.popup_quick_message(f'exception {e}', 'No settings file found... \
            will create one for you', keep_on_top=True, background_color='red', text_color='white')
        settings = default_settings
        save_settings(settings_file, settings, None)
    return settings


def save_settings(settings_file, settings, values):
    """Saves settings from dict to settings_file

    Args:
        settings_file (str): path to settings file
        settings (dict): settings in memory
        values (dict): contains currently selected or entered values in GUI window
    """
    if values:      # if there are stuff specified by another window, fill in those values
        for key in SETTINGS_KEYS_TO_ELEMENT_KEYS:  # update window with values read from settings
            try:
                settings[key] = values[SETTINGS_KEYS_TO_ELEMENT_KEYS[key]]
            except Exception:
                print(f'Problem updating settings from window values. Key = {key}')

    with open(settings_file, 'w', encoding='UTF-8') as f:
        jsondump(settings, f)

    sg.popup('Settings saved')

#Google Drive
def get_json(apikey, gdriveid, ps=200, pageToken=None):
    """Loads JSON file from Google Drive

    Args:
        apikey (str): Google API key to be used to load Drive info
        gdriveid (str): Google Drive id for root folder containing subfolders
        ps (int, optional): Page Size for returned JSON (how many results are returned per page). Defaults to 200.
        pageToken (str, optional): token used to load next page if there are remaining entries. Defaults to None.

    Returns:
        dict: dictionary containing info on each subfolder
    """
    url = f"https://www.googleapis.com/drive/v3/files?q='{gdriveid}'+in+parents&key={apikey}"
    if pageToken:
        url = f"{url}&pageToken={pageToken}"
    if ps:
        url = f"{url}&pageSize={ps}"
    response = urlopen(url)
    return loads(response.read())

def dict_to_list(files, json_file):
    """Converts json to list of dicts

    Args:
        files (list): List of files
        json_file (json): JSON File containing files info

    Returns:
        list: List of files from json file
    """
    for f in json_file.get('files'):
        files.append(f)
    return files

def view_video(ytid):
    """Opens Youtube video in default webbrowser

    Args:
        ytid (str): 11 character Youtube ID for video to download
    """
    url = f'https://www.youtube.com/watch?v={ytid}'
    webbrowser.open(url)

def get_video(m, mp3path, mp4path, tpath, ytid):
    """Downloads video from YouTube and convert to theme.mp3 in the movie directory

    Args:
        m (video): Movie from Plex API
        mp3path (str): path to store temp mp3
        mp4path (str): path to store temp mp4
        tpath (str): temp path used by downloader module
        ytid (str): 11 character Youtube ID for video to download
    """
    mpath = os.path.dirname(os.path.abspath(m.locations[0]))
    fpath = os.path.join(mpath, 'theme.mp3')
    url = f'https://www.youtube.com/watch?v={ytid}'
    video = YouTube(url)
    audio = video.streams.filter(only_audio=True, file_extension='mp4').first()
    audio.download(output_path=tpath, filename='theme.mp4')
    audio = afc(mp4path).subclip(0, 200) if video.length >= 201 else afc(mp4path)
    audio.write_audiofile(mp3path, verbose=False, logger=None)
    shutil.copy(mp3path, fpath)
    print('Theme downloaded and saved to movie directory.')
    return

def list_videos(m):
    """Searches YouTube for soundtrack theme songs for the selected movie

    Args:
        m (plexapi.video): movie being searched

    Returns:
        list: contains title and YouTube video id for each of up to 20 results
    """
    r = VideosSearch(f'"{m.title}" "{m.year}" "Movie" Soundtrack Theme Song', limit=20)
    return [{'title': i.get('title'), 'id': i.get('id')} for i in r.resultComponents]

def clear_youtube_list(window):
    """Empties the current Youtube List window and disabled associated buttons

    Args:
        window (PySimpleGui object): the primary GUI window
    """
    window["-YTID CUSTOM-"].update("")
    for i in range(10):
        yttxt = f"-YT TITLE {i}-"
        ytview = f"-YT VIEW {i}-"
        ytget = f"-YT GET {i}-"
        window[yttxt].update("")
        window[ytview].update(disabled=True)
        window[ytget].update(disabled=True)

def check_gd(m, gdmovies):
    """Checks to see if theme already exists in Google Drive

    Args:
        m (plexapi.video): movie object from Plex
        gdmovies (list): list containing all movies with theme songs on the Google Drive

    Returns:
        (tuple): a tuple containing:
            (dict): dictionary representing the matching movie from the Google Drive (if found)
            (bool): boolean representing success or failure of match
    """
    s = SIFT4()
    regstr = '^(.*\s\(\d\d\d\d\))'
    regstr2 = '^(.*)(?<!\(\d\d\d\d\))$'
    for i in gdmovies:
        gdtitle = i.get('name')
        if match := re.findall(regstr, gdtitle):
            title = f'{m.title} ({m.year})'
            gdtitle = match[0]
        elif match := re.findall(regstr2, gdtitle):
            title = f'{m.title}'
            gdtitle = match[0]
        if s.distance(gdtitle.lower(), title.lower()) <= 1:
            print('Found on Google Drive')
            return i, True
    return None, False

def gd_download(i, m, apikey):
    """Downloads theme from Google Drive to associated movie folder (Plex)

    Args:
        i (dict): dictionary representing the movie from the Google Drive
        m (plexapi.video): movie object from Plex
        APIKEY (str): constant containing the Google api key used to interact with Google Drive
    """
    file_id = i.get('id')
    url = f"https://www.googleapis.com/drive/v3/files/{file_id}?alt=media&key={apikey}"
    req = Request(url)
    req.add_header('User-agent', 'Mozilla/5.0')
    mpath = os.path.dirname(os.path.abspath(m.locations[0]))
    fpath = os.path.join(mpath, 'theme.mp3')
    with open(fpath, 'wb') as f:
        f.write(urlopen(req).read())

def get_all(window, apikey):
    global filterlist
    global gdmovies
    progress_bar = start_progress(window)
    for count, m in enumerate(filterlist, start=1):
        update_progress(progress_bar, count, filterlist)
        i, found = check_gd(m, gdmovies)
        if found is True:
            gd_download(i, m, apikey)
    progress_bar.update(visible=False)

def load_gdrive(window, update, apikey, gdriveid):
    global gdmovies
    pkl = os.path.join(os.getcwd(), 'gdrive.pkl')
    if not exists(pkl) or update:
        return update_from_gdrive(window, apikey, gdriveid, pkl)
    with open(pkl, "rb") as file:
        unpickler = pickle.Unpickler(file)
        gdmovies = unpickler.load()

def update_from_gdrive(window, apikey, gdriveid, pkl):
    global gdmovies
    print('Gathering movie list from Google Drive...')
    gdfolders = []
    gdmovies = []
    dj = get_json(apikey, gdriveid)
    gdfolders = dict_to_list(gdfolders, dj)
    progress_bar = window['-PROGRESS2-']
    window['-PROGRESST-'].update("This will take a few minutes:", visible=True)
    progress_bar.update(visible=True)
    window.refresh()

    while "nextPageToken" in dj:
        pageToken=dj.get('nextPageToken')
        dj = get_json(apikey, gdriveid, 200, pageToken)
        gdfolders = dict_to_list(gdfolders, dj)
    for count, f in enumerate(gdfolders, start=1):
        gdfiles = []
        percent_calc = round(count / len(gdfolders) * 100)
        progress_bar.update_bar(percent_calc)
        progress_bar.update()
        dj = get_json(apikey, f.get('id'))
        gdfiles.extend(iter(dj.get('files')))
        for gdf in gdfiles:
            if gdf.get('name') == "theme.mp3":
                mp3 = {'name': f.get('name'), 'id': gdf.get('id')}
                gdmovies.append(mp3)
    window['-PROGRESST-'].update(visible=False)
    progress_bar.update(visible=False)
    with open(pkl, "wb") as file:
        pickle.dump(gdmovies, file)

#Create connection to Plex Server
def connect_plex(url, token):
    print('Connecting to Plex')
    sess = requests.Session()
    # Ignore verifying the SSL certificate
    sess.verify = False
    if not sess.verify:
        # Disable the warning that the request is insecure, we know that...

        urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
    return PlexServer(url, token, session=sess), True
    #End Create connection to Plex Server

def start_progress(window, bar='-PROGRESS-'):
    progress_bar = window[bar]
    progress_bar.update(visible=True)
    window.refresh()
    return progress_bar

def update_progress(pbar, count, l):
    percent_calc = round(count / len(l) * 100)
    pbar.update_bar(percent_calc)
    pbar.update()

def load_plex_movies(lib, window, plex):
    global plexmovies
    global filterlist
    plexmovies = []
    filterlist = []
    filterpkl = []
    progress_bar = start_progress(window)
    librarylist = plex.library.section(lib).all()
    pkl = os.path.join(os.getcwd(), 'filterlist.pkl')
    for count, m in enumerate(librarylist, start=1):
        update_progress(progress_bar, count, librarylist)
        found = False
        mpath = os.path.dirname(os.path.abspath(m.locations[0])) #Path of Plex movie directory
        for _, _, files in os.walk(mpath):
            for file in files:
                if file == 'theme.mp3': #Check to see if theme.mp3 already exists
                    found = True
        if not found:
            plexmovies.append(m)
    window.write_event_value('End', None)
    progress_bar.update(visible=False)
    window["-MOVIE LIST-"].update(plexmovies)
    window["-FILTER-"].update(image_data=off_image)
    if exists(pkl):
        with open(pkl, "rb") as file:
            unpickler = pickle.Unpickler(file)
            filterpkl = unpickler.load()
            for m in librarylist:
                if m.key in filterpkl:
                    filterlist.append(m)


def filter_plex(window):
    global gdmovies
    global plexmovies
    global filterlist
    global filterstate
    pkl = os.path.join(os.getcwd(), 'filterlist.pkl')
    filterlist = []
    filterpkl = []
    filterstate = False
    progress_bar = start_progress(window, '-PROGRESS2-')
    window['-PROGRESST-'].update("This will take a few minutes:", visible=True)
    for count, i in enumerate(plexmovies, start=1):
        update_progress(progress_bar, count, plexmovies)
        _, found = check_gd(i, gdmovies)
        if found is True:
            filterlist.append(i)
            filterpkl.append(i.key)
    progress_bar.update(visible=False)
    window['-PROGRESST-'].update(visible=False)
    with open(pkl, "wb") as file:
        pickle.dump(filterpkl, file)
    window['-MOVIE LIST-'].update(filterlist)
    window['-FILTER-'].update(image_data=on_image)
    filterstate=True
    window['-GET ALL-'].update(disabled=False)

def filter_switch(window):
    global filterstate
    global filterlist
    global plexmovies
    if filterstate is True:
        filterstate = filter_flip(window, off_image, plexmovies, False)
    else:
        filterstate = filter_flip(window, on_image, filterlist, True)
    return filterstate


def filter_flip(window, image_data, arg2, arg3):
    window['-FILTER-'].update(image_data=image_data)
    window['-MOVIE LIST-'].update(arg2)
    fs = arg3
    window['-GET ALL-'].update(disabled=not fs)
    return fs

def get_poster(values):
    m_selected = values['-MOVIE LIST-'][0]
    poster = Image.open(requests.get(m_selected.posterUrl, stream = True, timeout=3).raw)
    pfile = os.path.join(tempfile.mkdtemp(), 'poster.png')
    poster.resize((200,300)).save(pfile, "PNG")
    return m_selected, pfile
#video.movie().__repr__ = movie_format

def adjust_font_size(text):
    bp = 260
    fontsize = 24
    font = ImageFont.truetype("arial.ttf", fontsize)
    while True:
        if font.getsize(text)[0] > bp:
            fontsize -= 1
        else:
            return fontsize
        font = ImageFont.truetype("arial.ttf", fontsize)

########################################## Make a settings window ##########################################
def create_settings_window(settings):
    sg.theme(settings['theme'])

    def TextLabel(text):
        return sg.Text(f'{text}:', justification='r', size=(15,1))

    layout = [  [sg.Text('Settings', font='Any 15')],
                [TextLabel('Plex URL'), sg.Input(k='-PLEX URL-', tooltip="Enter the url for your Plex server in the following format (http://xxx.xxx.xxx.xxx:xxxxx)")],
                [TextLabel('Plex Token'), sg.Input(k='-PLEX TOKEN-', tooltip="Enter your Plex Token")],
                [TextLabel('Google Drive ID'), sg.Input(k='-GDRIVE ID-', tooltip="Enter the Google Drive ID for the folder to save themes")],
                [TextLabel('Google API Key'), sg.Input(k='-APIKEY-', tooltip="Enter the Google API Key to use")],
                [TextLabel('Movie Library'), sg.Input(k='-MOVIE LIBRARY-', tooltip="Enter the name of your Plex movie library")],
                [TextLabel('Color Scheme'),sg.Combo(sg.theme_list(), size=(20, 20), k='-THEME-', tooltip="Change the Color Scheme")],
                [sg.Button('Save'), sg.Button('Exit')]  ]

    window = sg.Window('Settings', layout, keep_on_top=True, finalize=True)

    for key in SETTINGS_KEYS_TO_ELEMENT_KEYS:   # update window with the values read from settings file
        try:
            window[SETTINGS_KEYS_TO_ELEMENT_KEYS[key]].update(value=settings[key])
        except Exception as e:
            print(f'Problem updating PySimpleGUI window from settings. Key = {key}')

    return window

########################################## Main Program Window & Event Loop ##########################################
def create_main_window(settings):
    sg.theme(settings['theme'])
    PLEX_URL = settings['plex_url']
    PLEX_TOKEN = settings['plex_token']
    GDRIVEID = settings['gdriveid']
    APIKEY = settings['apikey']
    LIBRARY = settings['library']
    tpath,mp3path,mp4path = get_paths()
    #Top Row
    config_column = [
        [
            sg.Text("Update Google Drive List"),
            sg.Button("Update", enable_events=True, k='-LOAD GDRIVE-'),
            sg.Text("Update Filter List"),
            sg.Button("Update", enable_events=True, k='-LOAD FILTERLIST-'),
            sg.pin(sg.Text("", k="-PROGRESST-", visible=False)),
            sg.pin(sg.ProgressBar(100, orientation='h', size=(27, 22), k="-PROGRESS2-", visible=False)),
            sg.Push(),
            sg.Button("Settings", enable_events=True, k="-SETTINGS-")
        ]
    ]

    # Left Column
    file_list_column = [
        [
            sg.Frame('Plex Movies: ',[[sg.Button("Load", enable_events=True, k='-LOAD PLEX-', pad=((5,0), 3)),
            sg.pin(sg.ProgressBar(100, orientation='h', size=(13, 22), k="-PROGRESS-", visible=False, pad=(2, 3))),
            sg.Push(),
            sg.Text('Filter: ', font="arial 10", pad=(0, 3)),
            sg.Button(image_data=off_image_disabled, k='-FILTER-', border_width=0),
            sg.Button("Get All", enable_events=True, k='-GET ALL-', disabled=True, pad=((0,5), 3))]], size=(368, 54), vertical_alignment='t')
        ],
        [
            sg.Frame('Movie List: ', [[sg.Listbox(
                values=[], enable_events=True, select_mode='single', size=(48, 26), k="-MOVIE LIST-", auto_size_text=True, expand_y=True
            )]], vertical_alignment='t', expand_y=True)
        ]
    ]

    # Middle Column

    title_column = [
        [
            sg.Push(),
            sg.Frame('', [[sg.Text(text="No Movie Selected",  enable_events=True, k="-TITLE TEXT-", font=('Arial', 24))]], size=(400, 50), element_justification='c'),
            sg.Push()
        ]
    ]

    movie_data = [
        [
            sg.Frame('Director', [[sg.Text("", k="DIRECTOR", justification='c', size=(19, 1))]], title_location='n')
        ],
        [
            sg.Frame('Writer', [[sg.Text("", k="WRITER", justification='c', size=(19, 1))]], title_location='n')
        ],
        [
            sg.Frame('Starring', [[sg.Text("", k="STARRING", justification='c', size=(19, 2))]], title_location='n')
        ],
        [
            sg.Frame('Studio', [[sg.Text("", k="STUDIO", justification='c', size=(19, 1))]], title_location='n')
        ],
        [
            sg.Frame('Genre', [[sg.Text("", k="GENRE", justification='c', size=(19, 2))]], title_location='n')
        ]
    ]

    info_column = [
        [
            sg.Column(movie_data, vertical_alignment='t', size=(180, 300)),
            sg.Push(),
            sg.Frame('', [[sg.Image(filename=NO_POSTER, enable_events=True, k="-POSTER-", size=(200, 300), pad=(0,0,0,0))]], border_width=2, pad=(0,2,0,0)),
            sg.Text('', size=(1,1))
        ],
        [
            sg.Push(),
            sg.Frame('Description', [[sg.Text(text=lorem.paragraph(), enable_events=True, k="-DESCRIPTION-", size=(46, None), justification='c', expand_y=True)]], title_location='n', expand_y=True),
            sg.Push()

        ]
    ]

    display_column = [[sg.Frame('Movie Info:',[
        [
            sg.Column(title_column, justification='center')
        ],
        [
            sg.Column(info_column, justification='center')
            ]], vertical_alignment='t', expand_y=True, size=(420, 400))
        ],
        [
            sg.Frame('Soundtrack Options: ',[
            [sg.Text(text="", enable_events=True, k="-GD-"),
            sg.Push(),
            sg.Button(" Get Theme ", enable_events=True, k="-GD BUTTON-", disabled=True),
        ],
        [
            sg.Text(text="Search for the soundtrack on Youtube", enable_events=True, k="-YT-"),
            sg.Push(),
            sg.Button(" Search Youtube ", enable_events=True, k="-YOUTUBE BUTTON-", disabled=True)
        ]], vertical_alignment='b', expand_x=True)
    ]]

    # Right Column
    output_data = [[sg.Frame('Youtube Results: ', [
        [
            sg.Text("", k="-YT TITLE 0-", size=(35, 2), justification="left"),
            sg.Push(),
            sg.Button(" View ", k="-YT VIEW 0-", disabled=True),
            sg.Button(" Get ", k="-YT GET 0-", disabled=True)
        ],
        [
            sg.Text('_'*200, font=("arial", 2))
        ],
        [   sg.Text("", k="-YT TITLE 1-", size=(35, 2), justification="left"),
            sg.Push(),
            sg.Button(" View ", k="-YT VIEW 1-", disabled=True),
            sg.Button(" Get ", k="-YT GET 1-", disabled=True)
        ],
        [
            sg.Text('_'*200, font=("arial", 2))
        ],
        [   sg.Text("", k="-YT TITLE 2-", size=(35, 2), justification="left"),
            sg.Push(),
            sg.Button(" View ", k="-YT VIEW 2-", disabled=True),
            sg.Button(" Get ", k="-YT GET 2-", disabled=True)
        ],
        [
            sg.Text('_'*200, font=("arial", 2))
        ],
        [   sg.Text("", k="-YT TITLE 3-", size=(35, 2), justification="left"),
            sg.Push(),
            sg.Button(" View ", k="-YT VIEW 3-", disabled=True),
            sg.Button(" Get ", k="-YT GET 3-", disabled=True)
        ],
        [
            sg.Text('_'*200, font=("arial", 2))
        ],
        [
            sg.Text("", k="-YT TITLE 4-", size=(35, 2), justification="left"),
            sg.Push(),
            sg.Button(" View ", k="-YT VIEW 4-", disabled=True),
            sg.Button(" Get ", k="-YT GET 4-", disabled=True)
        ],
        [
            sg.Text('_'*200, font=("arial", 2))
        ],
        [   sg.Text("", k="-YT TITLE 5-", size=(35, 2), justification="left"),
            sg.Push(),
            sg.Button(" View ", k="-YT VIEW 5-", disabled=True),
            sg.Button(" Get ", k="-YT GET 5-", disabled=True)
        ],
        [
            sg.Text('_'*200, font=("arial", 2))
        ],
        [
            sg.Text("", k="-YT TITLE 6-", size=(35, 2), justification="left"),
            sg.Push(),
            sg.Button(" View ", k="-YT VIEW 6-", disabled=True),
            sg.Button(" Get ", k="-YT GET 6-", disabled=True)
        ],
        [
            sg.Text('_'*200, font=("arial", 2))
        ],
        [
            sg.Text("", k="-YT TITLE 7-", size=(35, 2), justification="left"),
            sg.Push(),
            sg.Button(" View ", k="-YT VIEW 7-", disabled=True),
            sg.Button(" Get ", k="-YT GET 7-", disabled=True)
        ],
        [
            sg.Text('_'*200, font=("arial", 2))
        ],
        [
            sg.Text("", k="-YT TITLE 8-", size=(35, 2), justification="left"),
            sg.Push(),
            sg.Button(" View ", k="-YT VIEW 8-", disabled=True),
            sg.Button(" Get ", k="-YT GET 8-", disabled=True)
        ],
        [
            sg.Text('_'*200, font=("arial", 2))
        ],
        [
            sg.Text("", k="-YT TITLE 9-", size=(35, 2), justification="left"),
            sg.Push(),
            sg.Button(" View ", k="-YT VIEW 9-", disabled=True),
            sg.Button(" Get ", k="-YT GET 9-", disabled=True)
        ],
        [
            sg.Text('_'*200, font=("arial", 2))
        ],
        [
            sg.Push(),
            sg.Button("Page 1", enable_events=True, k="PAGE1", disabled=True),
            sg.Button("Page 2", enable_events=True, k="PAGE2", disabled=True),
            sg.Push()
        ],
        [
            sg.VPush()
        ],
        [
            sg.vbottom(sg.Text("Enter Youtube Video ID", justification="right")),
            sg.vbottom(sg.In("", size=(12, 1), k="-YTID CUSTOM-")),
            sg.vbottom(sg.Button(" Get ", k="-YT GET CUSTOM-", disabled=True))
        ]], vertical_alignment='t', expand_y=True)
    ]]


    # ----- Full layout -----
    layout = [
        [
            sg.Column(config_column, expand_x=True, vertical_alignment='t')
        ],
        [
            sg.Column(file_list_column, vertical_alignment='t', expand_y=True),
            #sg.VSeperator(),
            sg.Column(display_column, vertical_alignment='t', expand_y=True),
            #sg.VSeparator(),
            sg.Column(output_data, k="-SEARCHCOL-", expand_y=True, vertical_alignment='t')
        ]
    ]
    return sg.Window('Plex Theme Songs', layout, resizable=True, icon="ThemeSong.ico"), PLEX_URL, PLEX_TOKEN, LIBRARY, tpath, mp3path, mp4path, APIKEY, GDRIVEID

def main():  # sourcery skip: extract-duplicate-method, low-code-quality
    window, settings = None, load_settings(SETTINGS_FILE, DEFAULT_SETTINGS)
    plex_connected = False
    global plexmovies
    global gdmovies
    global filterlist
    global filterstate
    plexmovies = []
    gdmovies = []
    filterlist = []
    filterstate = False
    while True:
        if window is None:
            window, PLEX_URL, PLEX_TOKEN, LIBRARY, tpath, mp3path, mp4path, APIKEY, GDRIVEID = create_main_window(settings)

        event, values = window.read()
        if not plex_connected:
            if PLEX_TOKEN is not None:
                plex, plex_connected = connect_plex(PLEX_URL, PLEX_TOKEN)
            else:
                window.write_event_value('-SETTINGS-', None)
        if (not gdmovies) or (event == "-LOAD GDRIVE-"):
            update = event == "-LOAD GDRIVE-"
            load_gdrive(window, update, APIKEY, GDRIVEID)
        if event in ["Exit", sg.WIN_CLOSED]:
            break
        elif event == "-SETTINGS-":
            event, values = create_settings_window(settings).read(close=True)
            if event == 'Save':
                window.close()
                window = None
                save_settings(SETTINGS_FILE, settings, values)
        elif event == "-LOAD FILTERLIST-":
            if not plexmovies:
                load_plex_movies(LIBRARY, window, plex)
            window["-FILTER-"].update(image_data=on_image_disabled)
            filter_plex(window)
        elif event == "-LOAD PLEX-":
            window["-LOAD PLEX-"].update(disabled=True)
            load_plex_movies(LIBRARY, window, plex)
        elif event == 'End':
            window["-LOAD PLEX-"].update(disabled=False)
        elif event == '-FILTER-':
            filter_switch(window)
        elif event == '-GET ALL-':
            get_all(window, gdmovies, APIKEY, filterlist)
        elif event == "-MOVIE LIST-" and len(values['-MOVIE LIST-']):
            clear_youtube_list(window)
            window["-YOUTUBE BUTTON-"].update(disabled=False)
            movie, img = get_poster(values)
            item, gd = check_gd(movie, gdmovies)
            if gd:
                window["-GD-"].update("Found theme on Google Drive.")
                window["-GD BUTTON-"].update(disabled=False)
            else:
                window["-GD-"].update("Theme not found on Google Drive.")
                window["-GD BUTTON-"].update(disabled=True)
            title = f"{movie.title} ({movie.year})"
            fontsize = adjust_font_size(title)
            genres = get_data_list(movie, 'genres', 10)
            actors = get_data_list(movie, 'actors', 5)
            window["-TITLE TEXT-"].update(font=('Arial', fontsize))
            window["-TITLE TEXT-"].update(title)
            window["-DESCRIPTION-"].update(movie.summary)
            if len(movie.directors) > 0:
                window["DIRECTOR"].update(movie.directors[0].tag)
            if len(movie.writers) > 0:
                window["WRITER"].update(movie.writers[0].tag)
            window["STARRING"].update(actors)
            window["GENRE"].update(genres)
            window["STUDIO"].update(textwrap.shorten(movie.studio, 25))
            window["-POSTER-"].update(img)


        elif event == "-GD BUTTON-":
            gd_download(item, movie, APIKEY)
        elif event == "-YOUTUBE BUTTON-":
            loop = 1
            vids = list_videos(movie)
            splits = list(divide_chunks(vids, 10))
            clear_youtube_list(window)
            gen_vids_list(window, splits, loop)
            window['-YT GET CUSTOM-'].update(disabled=False)
            if len(splits) == 2:
                window["PAGE1"].update(disabled=False)
                window["PAGE2"].update(disabled=False)
        elif event == "PAGE2":
            clear_youtube_list(window)
            loop = 2
            gen_vids_list(window, splits, loop)
        elif event == "PAGE1":
            clear_youtube_list(window)
            loop = 1
            gen_vids_list(window, splits, loop)
        for i in (range(10)):
            if event == f"-YT VIEW {i}-":
                ytid = splits[loop-1][i].get('id')
                view_video(ytid)
            if event == f"-YT GET {i}-":
                ytid = splits[loop-1][i].get('id')
                get_video(movie, mp3path, mp4path, tpath, ytid)
        if event == "-YT GET CUSTOM-":
            get_video(movie, mp3path, mp4path, tpath, values["-YTID CUSTOM-"])
    window.close()

def gen_vids_list(window, splits, loop):
    for count, v in enumerate(splits[loop - 1], start=0):
        yttxt = f"-YT TITLE {count}-"
        ytview = f"-YT VIEW {count}-"
        ytget = f"-YT GET {count}-"
        window[yttxt].update(textwrap.fill(textwrap.shorten(v.get('title'), 60), 35))
        window[ytview].update(disabled=False)
        window[ytget].update(disabled=False)
        window.refresh()

def get_data_list(movie, t, n):
    l = ''
    movie.reload()
    for i in range(min(len(getattr(movie, t)), n)):
        l = getattr(movie, t)[i].tag if i == 0 else f'{l}, {getattr(movie, t)[i].tag}'
    return l


def divide_chunks(l, n):
     
    # looping till length l
    for i in range(0, len(l), n):
        yield l[i:i + n]

if __name__ == "__main__":
    main()
